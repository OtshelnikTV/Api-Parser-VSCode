plugins {
    id 'java'
    id 'org.jetbrains.intellij' version '1.17.2'
}

group 'com.apiHelper'
version '1.0.4'

repositories {
    mavenCentral()
    google()
}

dependencies {
    // No backend parsing dependencies required; all logic runs in JS widget
}

intellij {
    version = '2021.3.3'
    type = 'IC'  // IC = Community Edition, IU = Ultimate
    plugins = []
}

tasks {
    patchPluginXml {
        sinceBuild = '212'
        untilBuild = '253.*'
    }

    signPlugin {
        certificateChain = System.getenv("CERTIFICATE_CHAIN")
        privateKey = System.getenv("PRIVATE_KEY")
        password = System.getenv("PRIVATE_KEY_PASSWORD")
    }

    publishPlugin {
        token = System.getenv("PUBLISH_TOKEN")
    }
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}

tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
}

tasks.withType(Test).configureEach {
    systemProperty 'file.encoding', 'UTF-8'
}